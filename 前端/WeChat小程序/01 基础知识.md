# 开发工具

微信开发者工具的五个主要组成部分
![[前端/WeChat小程序/Inbox/Pasted image 20240420173405.png]]

1. 帮助 -> 开发者文档可以直接定位开发者文档
2. 工具 -> 构建npm
3. 通过工具栏按钮可以控制区域的显示和隐藏
4. 详情 -> 查看小程序的基本信息, 调整小程序的设置
5. 模拟器区域可以选择对应的机型
6. 模拟器区域还可以看到并选择当前页面路径, 页面参数等一系列信息

# 项目结构

## 项目结构
![[前端/WeChat小程序/Inbox/Pasted image 20240420175012.png]]

1. **pages -> 存放所有小程序的页面**
2. utils -> 存放工具性质的模块
3. **app.js -> 小程序项目的入口**
4. **app.json -> 小程序项目全局配置文件**
5. app.wxss -> 小程序项目全局样式文件
6. project.config.json -> 项目配置文件
7. sitemap.json -> 配置小程序页面是否运行被微信索引

## 页面组成

建议把所有页面存入pages, 以单独的文件夹存在
![[前端/WeChat小程序/Inbox/Pasted image 20240420185334.png]]

每个页面由4个基本文件组成, 分别是
1. .js -> 页面脚本文件, 存放页面数据, 事件处理函数等
2. .json -> 页面配置文件, 配置当前页面窗口外观, 表现等
3. .wxml -> 页面模板结构文件, 
4. .wxss -> 页面样式表文件

## JSON配置文件

**作用**
对项目进行配置

#### 概览
小程序中共有4种json文件
1. 项目根目录的app.json配置文件
2. 项目根目录的project.config.json配置文件
3. 项目根目录的sitemap.json配置文件
4. 页面文件夹中的页面.json配置文件

#### app.json
当前小程序**全局配置文件**, 包含小程序所有页面路径, 窗口外观等

以Demo项目为例
```json
{
  "pages": [
    "pages/index/index",
    "pages/logs/logs"
  ],
  "window": {
    "navigationBarTextStyle": "black",
    "navigationBarTitleText": "Weixin",
    "navigationBarBackgroundColor": "#ffffff"
  },
  "style": "v2",
  "componentFramework": "glass-easel",
  "sitemapLocation": "sitemap.json",
  "lazyCodeLoading": "requiredComponents"
}
```
1. pages数组: 记录当前小程序所有页面路径
2. window: 全局定义小程序所有页面背景色, 文字颜色等数据
3. style: 全局定义小程序所有组件使用的样式版本
4. sitemapLocation: 指定sitemap.json的存储位置
5. lazyCodeLoading: 按需加载策略

#### project.config.json
记录对小程序开发工具的**个性化配置**

以Demo项目为例
```json
{
  "compileType": "miniprogram",
  "libVersion": "trial",
  "packOptions": {
    "ignore": [],
    "include": []
  },
  "setting": {
    "coverView": true,
    "es6": true,
    "postcss": true,
    "minified": true,
    "enhance": true,
    "showShadowRootInWxmlPanel": true,
    "packNpmRelationList": [],
    "babelSetting": {
      "ignore": [],
      "disablePlugins": [],
      "outputPath": ""
    }
  },
  "condition": {},
  "editorSetting": {
    "tabIndent": "auto",
    "tabSize": 2
  },
  "appid": "wxe24efb46827c548f"
}
```

1. setting -> 编译相关配置
2. appid -> 小程序账号id, 使用别人的项目首先要修改这个
3. 项目配置会自动体现在这个文件中

#### sitemap.json

小程序内搜索, 配置小程序页面是否允许微信索引
允许时, 微信会根据爬虫建立**索引关系**. 用户搜索关键字和索引匹配时, 就可以将小程序页面展示在搜索结果中

#### 页面.json

对本页面窗口外观进行配置, 同时会覆盖掉app.json全局配置window中重复的配置项

# 小程序页面

**新建小程序页面**
只需要在app.json的pages中添加页面存放路径, 开发工具就能自动添加对应的页面文件

**修改项目首页**
在app.json -> pages中处于**第一位**的就是项目首页
使用alt + 方向键可以快速移动

## WXML

**什么是WXML**
小程序框架设计的一套**标记语言, 用来构建小程序页面的结构**
类似于网页开发中的HTML

#### 区别

1. **标签名称**不同
2. **属性节点**不同 -> html是href , wxml中是url
3. 提供了类似于vue中的**模板语法**
	- 数据绑定
	- 列表渲染
	- 条件渲染

## WXSS

**什么是WXSS**
类似于网页开发中的CSS
描述wxml的样式

#### 区别

1. 新增了**rpx尺寸** -> 不同大小屏幕自动进行尺寸换算
2. 提供了**全局样式和局部样式** -> app.wxss作用于所有wxml页面, 页面.wxss作用于当前页面, 优先级高于全局
3. WXSS仅支持**CSS部分选择器**
	- .class和#id
	- element
	- 并集选择器, 后代选择器
	- ::after和::before伪类选择器

## JS逻辑交互

通过.js文件处理与用户的交互

#### 分类

1. app.js
	- 整个小程序的入口文件, 通过调用App()启动并运行小程序
2. 页面.js
	- 页面的入口文件, 调用Page()函数创建并运行对应的页面
3. 普通的.js文件
	- 封装公共的函数或属性供项目使用

# 宿主环境

**什么是宿主环境**
宿主环境是程序运行**所必须的依赖环境**

**小程序的宿主环境**
**手机微信**是小程序的宿主环境
小程序借助宿主环境可以完成很多普通网页无法完成的功能

**小程序宿主环境包含的内容**
1. 通信模型
2. 运行机制
3. 组件
4. API

## 通信模型

**通信的主体**
小程序中通信的主体是**渲染层**和**逻辑层**
1. WXML模板和WXSS样式工作在渲染层
2. JS脚本工作在逻辑层

**通信模型**
由微信**客户端进行转发**
1. 渲染层和逻辑层的通信
2. 逻辑层和第三方之间的通信

## 运行机制

**小程序启动过程**
1. 小程序代码包下载到本地
2. 解析app.json全局配置文件
3. 执行app.js入口文件, 调用App()创建小程序实例
4. 渲染小程序首页
5. 小程序启动完成

**页面渲染过程**
1. 加载解析页面.json配置文件
2. 加载页面.WXML模板和WXSS样式
3. 执行页面.js文件调用Page()函数创建页面实例

## 组件
小程序中的组件由宿主环境提供,可以基于此搭建出页面

**组件的分类**
1. **视图容器**
2. **基础内容**
3. **表单组件**
4. **导航组件**
5. 媒体组件
6. map地图组件
7. canvas画布组件
8. 开发能力
9. 无障碍访问

### 常用视图组件

##### view
- 普通视图区域
- 类似于HTML中div, 块级元素
- 常用来实现页面的布局效果

**基本使用**
- 与html中的view使用方法相同
- 使用时记得用container括起来

##### scroll-view
- 可滚动视图区域
- 常用来实现滚动列表效果

**使用**
- 最外层用scroll-view包括
- 添加属性scroll-y
- 为scroll-view添加固定的高度

##### swiper和swiper-item
- 轮播图容器组件和轮播图item组件

**使用**
- swipper作为容器，swipper-item作为项目
- 有几个项目，就添加几个item
- indicator-dots属性：显示面板指示点

**常用属性**
- indicator-dots: 是否显示面板指示点
- indicator-color: 指示点颜色
- indicator-active-color: 选中的指示点颜色
- autoplay: 自动切换
- interval: 自动切换时间间隔(单位ms)
- circular: 衔接滑动

### 常用基础内容组件

##### text
- 文本组件
- 类似于HTML中的span

**属性**
- selectable : 长按选中文本内容
- 小程序中只有text组件支持长按选中操作

##### rich-text
- 富文本组件
- 支持把html字符串渲染为wxml结构

**属性**
- **nodes** : 通过该属性节点, 可以把**HTML字符串渲染为对应的UI结构**

### 其他常用组件

##### button
- 按钮组件
- 功能比html的button按钮丰富
- 通过open-type属性可以调用微信提供的各种功能(客服, 转发, 获取授权, 获取用户信息等)

**属性**
- 使用type指定按钮类型
	- primary -> **主色调**, 与配置中的颜色一致
	- warn -> 警告按钮
- 使用size规定按钮尺寸
	- mini : **小按钮**, 不占用一行
- 使用plain规定**镂空按钮**

通过控制app.json中的style可以选择使用**新版样式**或是**旧版样式**

##### image
- 图片组件
- 默认宽度约300px, 宽度越240px

**属性**
- 使用src指定图片位置
- / 代表项目根目录

##### navigator
(后续讲解)
- 页面导航组件
- 类似HTML中的a标签
